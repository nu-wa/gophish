let admin_groups=[];const save=e=>{let a={name:$("#name").val(),users:$("#users").select2("data")};-1!==e?(a.id=e,api.adminGroupsId.put(a).success((e=>{successFlash(`Administration Groupe ${escapeHtml(a.name)} updated successfully!`),load(),dismiss(),$("#modal").modal("hide")})).error((e=>{modalError(e.responseJSON.message)}))):api.adminGroups.post(a).success((()=>{successFlash(`Admin group ${escapeHtml(a.name)} created successfully!`),load(),dismiss(),$("#modal").modal("hide")})).error((e=>{modalError(e.responseJSON.message)}))},edit=e=>{$("#modalSubmit").unbind("click").click((()=>{save(e)})),api.users.get().success((a=>{$("#users").select2({data:a.map((function(e){return e.text=e.username,e}))}),$("#users").val(null).trigger("change"),-1===e?$("#adminGroupModalLabel").text("New Administration Group"):($("#adminGroupModalLabel").text("Edit Administration Group"),api.adminGroupsId.get(e).success((e=>{$("#name").val(e.name);const s=a.map((function(a){return e.users&&void 0!==e.users.find((e=>e.id===a.id))?a.id:null}));$("#users").val(s).trigger("change")})).error((function(){errorFlash("Error fetching Administration Group")})))}))},load=()=>{$("#adminGroupsTable").hide(),$("#loading").show(),api.adminGroups.get().success((e=>{admin_groups=e,$("#loading").hide(),$("#adminGroupsTable").show();let a=$("#adminGroupsTable").DataTable({destroy:!0,columnDefs:[{orderable:!1,targets:"no-sort"}]});a.clear(),adminGroupsRows=[],$.each(admin_groups,((e,a)=>{adminGroupsRows.push([escapeHtml(a.name),"<div class='pull-right'>                        <button class='btn btn-primary edit_button' data-toggle='modal' data-backdrop='static' data-target='#modal' data-admin-group-id='"+a.id+"'>                            <i class='fa fa-pencil'></i>                        </button>                        <button class='btn btn-danger delete_button' data-admin-group-id='"+a.id+"'>                            <i class='fa fa-trash-o'></i>                        </button>                    </div>"])})),a.rows.add(adminGroupsRows).draw()})).error((()=>{errorFlash("Error fetching administration groups")}))},dismiss=()=>{$("#name").val(""),$("#modal\\.flashes").empty()},deleteAdminGroup=e=>{const a=admin_groups.find((a=>a.id==e));user&&Swal.fire({title:"Are you sure?",text:`This will delete the administration group '${escapeHtml(a.name)}'.\n\nThis can't be undone!`,type:"warning",animation:!1,showCancelButton:!0,confirmButtonText:"Delete",confirmButtonColor:"#428bca",reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(((a,s)=>{api.adminGroupsId.delete(e).success((e=>{a()})).error((e=>{s(e.responseJSON.message)}))})).catch((e=>{Swal.showValidationMessage(e)}))}}).then((e=>{e.value&&Swal.fire("Administration Group Deleted!"`The administration group ${escapeHtml(group.name)} has been deleted!`,"success"),$('button:contains("OK")').on("click",(function(){location.reload()}))}))};$(document).ready((function(){load(),$("#modal").on("hide.bs.modal",(function(){dismiss()})),$.fn.select2.defaults.set("width","100%"),$.fn.select2.defaults.set("dropdownParent",$("#users-select")),$.fn.select2.defaults.set("theme","bootstrap"),$("#new_button").on("click",(function(){edit(-1)})),$("#adminGroupsTable").on("click",".delete_button",(function(e){deleteAdminGroup($(this).attr("data-admin-group-id"))})),$("#adminGroupsTable").on("click",".edit_button",(function(e){edit($(this).attr("data-admin-group-id"))}))}));